<!doctype html>
<html class="no-js supports-no-cookies" lang="{{ shop.locale }}">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta name="theme-color" content="{{ settings.color_accent }}">
  <link rel="canonical" href="{{ canonical_url }}">

  {%- if settings.favicon != blank -%}
    <link rel="shortcut icon" href="{{ settings.favicon | img_url: '32x32' }}" type="image/png">
  {%- endif -%}

  {%- capture seo_title -%}
    {{ page_title }}
    {%- if current_tags -%}
      {%- assign meta_tags = current_tags | join: ', ' -%} &ndash; {{ 'general.meta.tags' | t: tags: meta_tags -}}
    {%- endif -%}
    {%- if current_page != 1 -%}
      &ndash; {{ 'general.meta.page' | t: page: current_page }}
    {%- endif -%}
    {%- assign escaped_page_title = page_title | escape -%}
    {%- unless escaped_page_title contains shop.name -%}
      &ndash; {{ shop.name }}
    {%- endunless -%}
  {%- endcapture -%}
  <title>{{ seo_title | strip }}</title>

  {%- if page_description -%}
    <meta name="description" content="{{ page_description | escape }}">
  {%- endif -%}

  {% include 'social-meta-tags' %}
  {% include 'style-tags', layout: 'theme' %}
  {% include 'css-variables' %}

  <script>
    document.documentElement.className = document.documentElement.className.replace('no-js', '');

    window.theme = {
      strings: {
        addToCart: {{ 'products.product.add_to_cart' | t | json }},
        soldOut: {{ 'products.product.sold_out' | t | json }},
        unavailable: {{ 'products.product.unavailable' | t | json }}
      },
      moneyFormat: {{ shop.money_format | json }}
    };

    {% if template.directory == 'customers' %}
      theme.allCountryOptionTags = {{ all_country_option_tags | json }};
    {% endif %}
  </script>

  {% include 'script-tags', layout: 'theme' %}

  {{ content_for_header }}
</head>

<body id="{{ page_title | handle }}" class="template-{{ template.name | handle }}">

  <a class="in-page-link visually-hidden skip-link" href="#MainContent">{{ 'general.accessibility.skip_to_content' | t }}</a>

  {% section 'header' %}

  <main role="main" id="MainContent">
    {{ content_for_layout }}


    {{ '//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js' | script_tag }}
    <h3 style="background-color:red;color:white;font-size:2em;">MESSAGES: <span class="messages"></div></h3>
    <a href="/cart" id="cart-number">View cart {{ cart.count }}</a>

    <script type="text/javascript">
      var Cart = {{ cart | json }};

      function getCart() {
        jQuery.getJSON('/cart.js', function(cart) {
          var Cart = cart;
          console.log(Cart)
        });
      }

      jQuery(document).ready(function(){
        $('[data-add-to-cart]').on('click', function(e) {
          var form = $(this).parents('form:first');
          e.preventDefault();
          addItem(form)
        });
      });

      function addItem(form) {
        console.log(form)
        jQuery.ajax({
          type: 'POST',
          url: '/cart/add.js',
          dataType: 'json',
          data: jQuery(form).serialize(),
          success: function(data) {
            addItemSuccess(data);
          },
          error: function(data) {
            addItemFail(data);
          }
        });
      }

      function addItemSuccess(product) {
        getCart();
        var newQuantity = Cart.item_count + product.quantity
        jQuery('.messages').html(product.title + ' was added to the cart!');
        jQuery('[data-cart-item-count]').replaceWith(newQuantity);
      }

      function addItemFail(data) {
        var parsedJSON = JSON.parse(data.responseText);
        jQuery('.messages').html(parsedJSON.description);
      }
    </script>

  </main>

  {% section 'footer' %}

</body>
</html>
